<%- include('../partials/header') %>

<div class="page-title-section">
    <h1 class="page-title">동호회 앨범</h1>
</div>

<div class="content-wrapper container">
    <% if (user) { %>
        <div style="text-align: right; margin-bottom: 2rem;">
            <button class="btn" onclick="toggleForm('albumForm')">앨범 등록</button>
        </div>
        <div id="albumForm" class="form-container" style="max-width: none; margin-bottom: 3rem; display: none;">
            <h3>사진/동영상 업로드</h3>
            <form action="/album/upload" method="POST" enctype="multipart/form-data">
                <div class="form-group">
                    <label for="caption">설명</label>
                    <input type="text" id="caption" name="caption">
                </div>
                <div class="form-group">
                    <label for="mediaFile">파일 선택</label>
                    <input type="file" id="mediaFile" name="mediaFile" accept="image/*,video/*" required>
                </div>
                <div class="btn-group">
                    <button type="submit" class="btn">업로드</button>
                </div>
            </form>
        </div>
    <% } %>

    <div class="grid-container">
        <% photos.forEach(photo => { %>
            <a href="/album/<%= photo.id %>" class="grid-item">
                <% if (photo.fileType === 'image') { %>
                    <img src="/uploads/album/<%= photo.filePath %>" alt="<%= photo.caption %>">
                <% } else { %>
                    <video src="/uploads/album/<%= photo.filePath %>"></video>
                <% } %>
                <h3><%= photo.caption %></h3>
                <p>Uploader: <%= photo.uploader_nickname || '탈퇴한 회원' %></p>
            </a>
        <% }) %>
    </div>
</div>

<script>
    function toggleForm(formId) {
        const form = document.getElementById(formId);
        form.style.display = form.style.display === 'none' ? 'block' : 'none';
    }
</script>

<%- include('../partials/footer') %>